{% extends "base.html" %}

{% block title %}Cast Your Vote{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
    <!-- Progress Steps -->
    <div class="flex items-center justify-between mb-8">
        <div class="flex items-center">
            <div class="bg-green-600 rounded-full h-8 w-8 flex items-center justify-center text-white font-semibold">
                <i class="fas fa-check"></i>
            </div>
            <div class="ml-2 text-sm font-medium text-gray-900">Connect Wallet</div>
        </div>
        <div class="h-0.5 w-16 bg-green-600"></div>
        <div class="flex items-center">
            <div class="bg-green-600 rounded-full h-8 w-8 flex items-center justify-center text-white font-semibold">
                <i class="fas fa-check"></i>
            </div>
            <div class="ml-2 text-sm font-medium text-gray-900">Biometric Verification</div>
        </div>
        <div class="h-0.5 w-16 bg-blue-600"></div>
        <div class="flex items-center">
            <div class="bg-blue-600 rounded-full h-8 w-8 flex items-center justify-center text-white font-semibold">3</div>
            <div class="ml-2 text-sm font-medium text-gray-900">Vote</div>
        </div>
    </div>

    <!-- Biometric Verification Status -->
    <div id="biometricStatus" class="mb-6 p-4 bg-blue-50 rounded-lg">
        <div class="flex">
            <div class="flex-shrink-0">
                <i class="fas fa-fingerprint text-blue-500"></i>
            </div>
            <div class="ml-3">
                <h3 class="text-sm font-medium text-blue-800">Biometric Verification</h3>
                <div class="mt-2 text-sm text-blue-700">
                    <p>Verification ID: <span id="verificationIdDisplay" class="font-mono">{{ verification_id }}</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Voting Card -->
    <div class="bg-white shadow rounded-lg p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">Cast Your Vote</h2>
        
        <!-- Voting Status -->
        <div id="votingStatus" class="mb-6 p-4 bg-yellow-50 rounded-lg hidden">
            <div class="flex">
                <div class="flex-shrink-0">
                    <i class="fas fa-info-circle text-yellow-400"></i>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm font-medium text-yellow-800">Voting Status</h3>
                    <div class="mt-2 text-sm text-yellow-700">
                        <p id="statusMessage">Checking voting status...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Candidates List -->
        <div id="candidatesList" class="space-y-4">
            <p class="text-gray-500 text-center">Loading candidates...</p>
        </div>

        <!-- Vote Button -->
        <div class="mt-6 flex justify-end">
            <button id="voteButton" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed">
                Cast Vote
            </button>
        </div>
    </div>
</div>

<!-- Transaction Status Modal -->
<div id="transactionModal" class="fixed z-10 inset-0 overflow-y-auto hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        <div class="inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-sm sm:w-full sm:p-6">
            <div>
                <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-blue-100">
                    <i id="modalIcon" class="fas fa-spinner fa-spin text-blue-600"></i>
                </div>
                <div class="mt-3 text-center sm:mt-5">
                    <h3 class="text-lg leading-6 font-medium text-gray-900" id="modalTitle">
                        Processing Vote
                    </h3>
                    <div class="mt-2">
                        <p class="text-sm text-gray-500" id="modalMessage">
                            Please confirm the transaction in MetaMask...
                        </p>
                    </div>
                </div>
            </div>
            <div class="mt-5 sm:mt-6 hidden" id="modalButton">
                <button type="button" class="inline-flex justify-center w-full rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>

<script src="/static/js/vote.js"></script>
{% endblock %}